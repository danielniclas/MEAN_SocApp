var app=angular.module("app",["ngRoute"]);console.log("In the MODULAR Angular files in 'ng' directory");var app=angular.module("app");app.controller("ApplicationCtrl",["$scope","$rootScope",function(t,e){t.$on("login",function(e,o){t.currentUser=o}),e.intercept=!1}]);var app=angular.module("app");app.service("authInterceptor",["$rootScope","$q",function(t,e){var o=this;o.responseError=function(o){return 401==o.status&&(console.log("INTERCEPTOR ERROR 401"),t.intercept="true"),e.reject(o)}}]),app.config(["$httpProvider",function(t){t.interceptors.push("authInterceptor")}]);var app=angular.module("app");app.controller("LoginCtrl",["$scope","UserSvc",function(t,e){t.login=function(o,r){function n(){t.$watch("$rootScope.intercept",function(e,o){console.log("Watcher triggered"),t.unauthorized=!0})}e.login(o,r).then(function(e){t.$emit("login",e.data)}),setTimeout(n,0)}}]);var app=angular.module("app");app.controller("PostsCtrl",["$scope","PostsSvc",function(t,e){t.addPost=function(){t.postBody&&(post={username:"MookersService",body:t.postBody},e.create(post).success(function(e){t.posts.unshift(e),t.postBody=null}),t.postBody=null)},e.fetch().success(function(e){t.posts=e})}]);var app=angular.module("app");app.service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("api/posts")},this.create=function(e){return t.post("api/posts",e)}}]);var app=angular.module("app");app.controller("RegistrationCtrl",["$scope","UserSvc",function(t,e){t.register=function(o,r){e.createUser(o,r).then(function(e){t.$emit("login",e.data)})}}]);var app=angular.module("app");app.config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/register",{controller:"RegistrationCtrl",templateUrl:"register.html"})}]);var app=angular.module("app");app.service("UserSvc",["$http",function(t){var e=this;e.getUser=function(){return t.get("/api/users")},e.login=function(o,r){return t.post("/api/sessions",{username:o,password:r}).then(function(o){return e.token=o.data,t.defaults.headers.common["x-auth"]=o.data,e.getUser()})},e.createUser=function(o,r){return t.post("/api/users",{username:o,password:r}).then(function(){return e.login(o,r)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJpbnRlcmNlcHRvci5zdmMuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdHJhdGlvbi5jdHJsLmpzIiwicm91dGVzLmpzIiwidXNlci5zdmMuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnNvbGUiLCJsb2ciLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJpbnRlcmNlcHQiLCJzZXJ2aWNlIiwiJHEiLCJ0aGlzIiwicmVzcG9uc2VFcnJvciIsInJlc3BvbnNlIiwic3RhdHVzIiwicmVqZWN0IiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImludGVyY2VwdG9ycyIsInB1c2giLCJVc2VyU3ZjIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiaW50ZXJjZXB0V2F0Y2hlciIsIiR3YXRjaCIsIm5ld1ZhbHVlIiwib2xkVmFsdWUiLCJ1bmF1dGhvcml6ZWQiLCJ0aGVuIiwiJGVtaXQiLCJkYXRhIiwic2V0VGltZW91dCIsIlBvc3RzU3ZjIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwicG9zdCIsImJvZHkiLCJjcmVhdGUiLCJzdWNjZXNzIiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCIkaHR0cCIsImdldCIsInJlZ2lzdGVyIiwiY3JlYXRlVXNlciIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwic3ZjIiwiZ2V0VXNlciIsInZhbCIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIl0sIm1hcHBpbmdzIjoiQUFJQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLE9BQUEsV0FFQUMsU0FBQUMsSUFBQSxpRENGQSxJQUFBSixLQUFBQyxRQUFBQyxPQUFBLE1BQ0FGLEtBQUFLLFdBQUEsbUJBQUEs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TUFBQW9CLEdBQUFQLEtBQUEsY0FBQWQsU0FBQUEsRUFBQUMsU0FBQUEsSUFFQU0sS0FBQSxXQUVBLE1BQUFxQixHQUFBN0IsTUFBQUMsRUFBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhbmllbG5pY2xhcyBvbiAxLzQvMTYuXG4gKi9cblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nUm91dGUnXSk7ICAgICAgICAgICAgLy8gIDw8ICBTRVRURVIgTU9EVUxFIC0tICBDYWxsZWQgT05MWSBPTkNFIGFuZCBGSVJTVFxuXG5jb25zb2xlLmxvZyhcIkluIHRoZSBNT0RVTEFSIEFuZ3VsYXIgZmlsZXMgaW4gJ25nJyBkaXJlY3RvcnlcIik7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhbmllbG5pY2xhcyBvbiA0LzEwLzE2LlxuICovXG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XG5hcHAuY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlKXtcblxuXG4gICAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbihfLCB1c2VyKXsgICAgICAgICAgICAgIC8vICAkc2NvcGUub24gKDEuICBuYW1lIG9mIEVtaXR0ZXIsIENCIGZ1bmN0aW9uKVxuXG5cbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjsgICAgICAgICAgICAgICAgICAgICAgLy8gIFRoaXMgaXMgd2hlcmUgdGhlIFVTRVIgSlNPTiBlbmRzIHVwISEhXG5cblxuICAgIH0pO1xuXG5cbiAgICAkcm9vdFNjb3BlLmludGVyY2VwdCA9IGZhbHNlO1xuXG59KTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgZGFuaWVsbmljbGFzIG9uIDQvMTAvMTYuXG4gKi9cblxuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xuXG4gICAgYXBwLnNlcnZpY2UoJ2F1dGhJbnRlcmNlcHRvcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRxKSB7XG5cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB0aGlzO1xuXG5cblxuICAgICAgICBzZXJ2aWNlLnJlc3BvbnNlRXJyb3IgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpe1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJTlRFUkNFUFRPUiBFUlJPUiA0MDFcIik7XG5cbiAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbiA9IFwiL2xvZ2luXCI7XG5cbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmludGVyY2VwdCA9IFwidHJ1ZVwiXG5cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cblxuXG4gICAgYXBwIC5jb25maWcoWyckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xuICAgICAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcbiAgICB9XSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhbmllbG5pY2xhcyBvbiA0LzgvMTYuXG4gKi9cblxuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xuXG5hcHAuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLFVzZXJTdmMpeyAgICAgICAvLyAgQ0hJTEQgQ09OVFJPTExFUiB0byBBcHBsY2F0aW9uQ3RybFxuXG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCl7ICAgLy8gIEZ1bmN0aW9uIGV4cG9zZWQgdG8gTG9naW4gRm9ybVxuXG4gICAgICAgIFVzZXJTdmMubG9naW4odXNlcm5hbWUscGFzc3dvcmQpICAgICAgICAgICAvLyAgbG9naW4uY3RybC5qcyAgPj4gIFVzZXJTdmMubG9naW4oKSAgPj4+PiByZXR1cm5zIFVTRVIgSlNPTiA8PDw8PFxuXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG5cbiAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2xvZ2luJywgcmVzcG9uc2UuZGF0YSk7ICAgIC8vICBlbWl0KCkgb3IgYnViYmxlIHVwIHRoZSBVU0VSIEpTT04gPj4gYXBwbGljYXRpb24uY3RybFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gIFBhc3MgdGhpcyBldmVudCBmcm9tIENISUxEIENPTlRST0xMRVIgKGxvZ2luLmN0cmwpIHVwIHRvIFBBUkVOVCBDT05UUk9MTEVSIChhcHBsaWNhdGlvbi5jdHJsKSB1c2luZyAkZW1pdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICRlbWl0IGlzIGFuIEFOR1VMQVIgRVZFTlRcblxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codXNlcik7ICAgICAgICAgICAgICAgICAgIC8vICBESVNQTEFZIFVTRVIgIDw8ICBUaGlzIGZ1bmN0aW9uIGRpc3BsYXlzIGRhdGEuICBEb2VzIG5vdCBSRVRVUk4gYW4gZXZhbHVhdGVkIGV4cHJlc3Npb25cblxuICAgICAgICAgICAgfSk7XG5cblxuXG5cbiAgICAgICAgc2V0VGltZW91dChpbnRlcmNlcHRXYXRjaGVyLCAwKTtcblxuICAgICAgICBmdW5jdGlvbiBpbnRlcmNlcHRXYXRjaGVyICgpIHtcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJyRyb290U2NvcGUuaW50ZXJjZXB0JywgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXYXRjaGVyIHRyaWdnZXJlZFwiKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUudW5hdXRob3JpemVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhbmllbG5pY2xhcyBvbiAxLzQvMTYuXG4gKi9cblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTsgICAgICAgICAgLy8gIEdFVFRFUiBNT0RVTEVcblxuYXBwLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjKSB7XG5cbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgaWYoJHNjb3BlLnBvc3RCb2R5KXsgICAgICAgICAgICAgICAgLy9wb3N0Qm9keSBpcyB0aGUgdmFsdWUgb2YgdGhlIGlucHV0IGZpZWxkXG5cbiAgICAgICAgICAgIHBvc3QgPSB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6ICAnTW9va2Vyc1NlcnZpY2UnLFxuICAgICAgICAgICAgICAgIGJvZHk6ICRzY29wZS5wb3N0Qm9keVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHBvc3QpXG5cblxuICAgICAgICAgICAgICAgIC8vJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHsgICAgICAvLyAgJGh0dHAgcmVxdWVzdCB0byBFTkRQT0lOVCAgLS0gIFRvIE5vZGUgQVBJXG4gICAgICAgICAgICAgICAgLy8gICAgLy8gIHBvc3QoMSwyKSAgIDEuICAvYXBpL3Bvc3QvIGVuZHBvaW50IE5vZGUgQVBJLCAyLiAgT0JKRUNUIHRvIHBvc3RcbiAgICAgICAgICAgICAgICAvLyAgICAvLyAgQ1JFQVRFIE9CSkVDVDpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vICAgIHVzZXJuYW1lOiAgJ01vb2tlcnMnLFxuICAgICAgICAgICAgICAgIC8vICAgIGJvZHk6ICRzY29wZS5wb3N0Qm9keVxuICAgICAgICAgICAgICAgIC8vfSlcblxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3QpIHsgICAgICAgICAgICAgICAgICAgIC8vICAkaHR0cCBSRVRVUk5TIEEgUFJPTUlTRSBPQkpFQ1QgISEhIVxuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpOyAgICAgLy8gIGlmIGNyZWF0aW5nIG5ldyBPQkpFQ1QgaXMgc3VjY2VzcyAtPiBBZGQgb2JqZWN0IHRvIFtwb3N0c10gQVJSQVlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgYXJyYXkudW5zaGlmdCgpIC0tICBhZGQgbmV3IGl0ZW1zIHRvIHRoZSBiZWdpbm5pbmcgb2YgYW4gYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgQW5ndWxhciBpcyBtYW5hZ2luZyB0aGUgQVJSQVkgISEhICBhcyBwYXJ0IG9mICRzY29wZVxuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGw7ICAgICAgICAgIC8vICBzZXQgcG9zdEJvZHkgdmFsdWUgdG8gTlVMTFxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgLy8gJGh0dHAuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3RzJykgICAgICAgIC8vICBHZXQgW3Bvc3RzXSBBUlJBWSAgKHRoaXMgY29kZSByZXBsYWNlcyB0aGUgW3Bvc3RdIEFSUkFZIGJlbG93XG5cbiAgICBQb3N0c1N2Yy5mZXRjaCgpXG5cblxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAocG9zdHMpIHsgICAgICAgICAgICAgICAgICAgICAvLyAgJGh0dHAgcmV0dXJucyBhIFBST01JU0UgT0JKRUNUXG4gICAgICAgICAgICAkc2NvcGUucG9zdHMgPSBwb3N0c1xuICAgICAgICB9KTtcblxufSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgZGFuaWVsbmljbGFzIG9uIDEvNC8xNi5cbiAqL1xuXG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7ICAgICAgLy8gIEdFVFRFUiBNT0RVTEVcblxuXG4vLyAgU2VydmljZTpcblxuYXBwLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCdhcGkvcG9zdHMnKTsgICAgICAgICAgICAgICAgIC8vICAkaHR0cC5nZXQoKSBTRVJWSUNFICAtLSByZXR1cm5zIGEgUFJPTUlTRVxuICAgIH07XG4gICAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAocG9zdCkgeyAgICAgICAgICAgICAgICAgICAgIC8vICAkaHR0cC5wb3N0KCkgU0VSVklDRSAtLSAgcmV0dXJucyBhIFBST01JU0VcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9wb3N0cycsIHBvc3QpXG4gICAgfVxufSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhbmllbG5pY2xhcyBvbiA0LzEwLzE2LlxuICovXG5cblxuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xuXG5hcHAuY29udHJvbGxlcignUmVnaXN0cmF0aW9uQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSxVc2VyU3ZjKXsgICAgICAgLy8gIENISUxEIENPTlRST0xMRVIgdG8gQXBwbGNhdGlvbkN0cmxcblxuICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpeyAgICAgICAgLy8gIGZ1bmN0aW9uIGV4cG9zZWQgdG8gUmVnaXN0ZXIgRm9ybVxuXG4gICAgICAgIFVzZXJTdmMuY3JlYXRlVXNlcih1c2VybmFtZSxwYXNzd29yZCkgICAgICAgICAgIC8vICBsb2dpbi5jdHJsLmpzICA+PiAgVXNlclN2Yy5sb2dpbigpICA+Pj4+IHJldHVybnMgVVNFUiBKU09OIDw8PDw8XG5cbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcblxuICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKTsgICAgLy8gIGVtaXQoKSBvciBidWJibGUgdXAgdGhlIFVTRVIgSlNPTiA+PiBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgUGFzcyB0aGlzIGV2ZW50IGZyb20gQ0hJTEQgQ09OVFJPTExFUiAobG9naW4uY3RybCkgdXAgdG8gUEFSRU5UIENPTlRST0xMRVIgKGFwcGxpY2F0aW9uLmN0cmwpIHVzaW5nICRlbWl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgJGVtaXQgaXMgYW4gQU5HVUxBUiBFVkVOVFxuXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh1c2VyKTsgICAgICAgICAgICAgICAgICAgLy8gIERJU1BMQVkgVVNFUiAgPDwgIFRoaXMgZnVuY3Rpb24gZGlzcGxheXMgZGF0YS4gIERvZXMgbm90IFJFVFVSTiBhbiBldmFsdWF0ZWQgZXhwcmVzc2lvblxuICAgICAgICAgICAgfSlcbiAgICB9XG59KTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgZGFuaWVsbmljbGFzIG9uIDQvOC8xNi5cbiAqL1xuXG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpe1xuXG5cbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAud2hlbignLycsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3JlZ2lzdGVyJywge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvbG9naW4nLCB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9yZWdpc3RlcicsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RyYXRpb25DdHJsJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCdcbiAgICAgICAgfSlcbn0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSBkYW5pZWxuaWNsYXMgb24gNC84LzE2LlxuICovXG5cblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcblxuYXBwLnNlcnZpY2UoJ1VzZXJTdmMnLGZ1bmN0aW9uKCRodHRwKXtcblxuICAgIHZhciBzdmMgPSB0aGlzO1xuXG5cblxuXG4gICAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKTsgICAgICAgICAvLyAgUkVUVVJOIGEgSlNPTiBvZiB0aGUgVVNFUiAgID4+ICBFTkRTIFVQIHdpdGggYXBwbGljYXRpb24uY3RybFxuXG4gICAgfTtcblxuICAgIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpeyAgICAgICAvLyA8PCAgVXNlclN2Yy5sb2dpbih1c2VybmFtZSxwYXNzd29yZCkgIElOVk9LRUQgaW4gQ29udHJvbGxlciAgPDw8PCAgbmctc3VibWl0IGluIGxvZ2luLmh0bWxcblxuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHt1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZH0pICAgICAgICAgLy8gIDEuICBSRVNPTFZFIFRISVMgIChSRVRVUk4pICA+PiBnZW5lcmF0ZSBKV1RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICA8PCAgQ1VSTCAtLSBVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICBQT1NUIHVzZXJuYW1lIGFuZCBwYXNzd29yZCA+PiAgY29tcGFyZSBwYXNzd29yZCB3aXRoIEhBU0ggcGFzc3dvcmQgPj4gIGdlbmVyYXRlIEpXVCBUT0tFTlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gIDw8ICBDVVJMISEgIGNoZWNrOiAgc2VydmVyLWF1dGguanNcblxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHZhbCl7ICAgICAgICAgICAgICAgICAgIC8vICB2YWwgaXMgdGhlIE9CSkVDVCByZXR1cm5lZCBmcm9tICRodHRwLnBvc3QgPj4gIHt2YWx9XG5cbiAgICAgICAgICAgICAgICAgICAgc3ZjLnRva2VuID0gdmFsLmRhdGE7ICAgICAgICAgICAvLyAgdmFsLmRhdGEgPSBKV1QgVE9LRU4gIGFzc2lnbiB0bzogICBVc2VyU3ZjLnRva2VuXG5cbiAgICAgICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gdmFsLmRhdGE7ICAgICAvLyAgQUxMIFJFUVVFU1RTIHdpbGwgaGF2ZSB0aGlzIGhlYWRlciBhdHRhY2hlZCAgPDwgIHVzZXIgZGF0YSBmcm9tIEpXVFxuXG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKCk7ICAgICAgICAgICAvLyAgSU5WT0tFIFVzZXJTdmMuZ2V0VXNlcigpICBhbmQgPj4+Pj4+IFJFVFVSTiB0aGUgVVNFUiB7T0JKRUNUfSAgPDwgIFJFU09MVkUgVEhJU1xuICAgICAgICAgICAgICAgIH0pXG4gICAgfTtcblxuXG4gICAgc3ZjLmNyZWF0ZVVzZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpeyAgICAgICAgICAgICAgLy8gIFJFR0lTVFJBVElPTjogIGNyZWF0ZSB1c2VyID4+ICBsb2dpblxuXG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge3VzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkfSkgICAgICAgLy8gIFJlc29sdmUgdGhpcyBmaXJzdDogIEZJUlNUOiAgPj4gIENSRUFURSBUSEUgVVNFUiBhbmQgU0FWRSBUTyBEQiB3aXRoIC9hcGkvdXNlcnNcblxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgdGhlbiA+PlxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpOyAgICAgICAgICAgICAgIC8vICBXaGVuIGRvbmUgY3JlYXRpbmcgdXNlciA+PiAgU0VDT05EOiAgPj4gc3ZjLmxvZ2luICB3aGljaCB1bHRpbWF0ZWx5IHJldHVybnMgSlNPTiBvZiBVU0VSID4+ICB3aGljaCB0aGVuIGdldHMgYnViYmxlZCB1cCB3aXRoIGVtaXQoKVxuXG4gICAgICAgIH0pXG4gICAgfVxuXG59KTtcblxuLy8gIFJFVFVSTiAgPDwgIGFueXRoaW5nIGFmdGVyIFJFVFVSTiBpcyBSRVNPTFZFRCBhbmQgcmV0dXJuZWQgdG8gdGhlIElOVk9LQVRJT04gc3RhdGVtZW50XG5cblxuXG4vLyAgTG9naW4gaGFzIHR3byBzdGVwczpcbi8vICAxLiAgUE9TVCAvYXBpL3Nlc3Npb25zID4+IGNvbXBhcmUgcGFzc3dvcmQgd2l0aCBIQVNIICA+PiBKV1QgVE9LRU5cbi8vICAyLiAgR0VUIC9hcGkvdXNlcnMgID4+ICBSZXR1cm4gSlNPTiBvZiBVU0VSIGZyb20gREIgICh1c2VybmFtZSBhbmQgSEFTSCkgID4+ICBDb250cm9sbGVyOiAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyICA+PiAgVmlldzogIFNpZ25lZCBpbiBhcyB7e2N1cnJlbnRVc2VyLnVzZXJuYW1lfX1cblxuLy8gIFJlZ2lzdHJhdGlvbiBoYXMgdGhyZWUgc3RlcHM6XG4vLyAgMS4gIFBPU1QgL2FwaS91c2VycyAgPj4gIGNyZWF0ZSB1c2VyIGFuZCBzYXZlIHRvIERCIC0gJ3VzZXInIFNjaGVtYSAodXNlcm5hbWUgYW5kIEhBU0gpXG4vLyAgMi4gIFBPU1QgL2FwaS9zZXNzaW9uICAgPj4gY29tcGFyZSBwYXNzd29yZCB3aXRoIEhBU0ggID4+IEpXVCBUT0tFTlxuLy8gIDMuICBHRVQgL2FwaS91c2VycyA+PiAgUmV0dXJuIEpTT04gb2YgVVNFUiBmcm9tIERCIC0gJ3VzZXInIFNjaGVtYSAodXNlcm5hbWUgYW5kIEhBU0gpICA+PiAgQ29udHJvbGxlcjogJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlciAgPj4gIFZpZXc6ICBTaWduZWQgaW4gYXMge3tjdXJyZW50VXNlci51c2VybmFtZX19XG5cblxuLy8gIENoZWNrIE5FVFdPUksgVEFCIGluIENIUk9NRSAgPj4gIHNlc3Npb25zID4+ICB3aWxsIHNob3cgdGhlIHVzZXJuYW1lIGFuZCBwYXNzd29yZCBiZWluZyBQQVNTRURcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
